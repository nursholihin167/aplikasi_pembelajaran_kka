<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Aplikasi Pembelajaran SMA</title>
<style>
body{font-family:Segoe UI;background:#f2f4f8;margin:0}
header{background:#1e3c72;color:#fff;padding:15px;text-align:center}
.container{max-width:1000px;margin:auto;padding:20px}
.card{background:#fff;padding:15px;border-radius:10px;margin:15px 0}
button{padding:10px 15px;border:none;border-radius:8px;background:#1e3c72;color:#fff;margin:5px}
button:hover{background:#2a5298}
input,select,textarea{width:100%;padding:8px;margin:5px 0}
.hidden{display:none}
</style>
</head>
<body>

<header>
<h2>Aplikasi Pembelajaran Informatika & KKA</h2>
</header>

<div class="container">

<!-- LOGIN -->
<div id="loginBox" class="card">
<h3>Login</h3>
<input id="loginUser" placeholder="Username">
<input id="loginPass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<p id="infoLogin"></p>
<button onclick="showRegister()">Daftar Siswa</button>
</div>

<!-- REGISTER -->
<div id="registerBox" class="card hidden">
<h3>Daftar Siswa</h3>
<input id="regNama" placeholder="Nama Lengkap">
<input id="regUser" placeholder="Username">
<input id="regPass" type="password" placeholder="Password">

<select id="regKelas">
 <option value="">Pilih Kelas</option>
</select>

<select id="regAbsen">
 <option value="">Pilih Absen</option>
</select>

<button onclick="registerSiswa()">Daftar</button>
<button onclick="backLogin()">Kembali</button>
</div>

<!-- MENU SISWA -->
<div id="menuSiswa" class="hidden">
<h3 id="infoSiswa"></h3>
<button onclick="pilihMapel('informatika')">üìò Informatika</button>
<button onclick="pilihMapel('kka')">ü§ñ KKA</button>
<button onclick="logout()">Logout</button>
</div>

<!-- MENU MAPEL -->
<div id="menuMapel" class="hidden">
<h3 id="judulMapel"></h3>
<button onclick="bukaMateri()">üìñ Materi</button>
<button onclick="bukaLatihan()">üìù Latihan</button>
<button onclick="kembaliSiswa()">‚¨Ö Kembali</button>
</div>

<!-- MATERI -->
<div id="materiBox" class="hidden">
<h3>Materi</h3>
<div id="materiList"></div>
<button onclick="kembaliMenuMapel()">‚¨Ö Kembali</button>
</div>

<!-- LATIHAN -->
<div id="latihanBox" class="hidden">
<h3>Latihan</h3>
<div id="soalList"></div>
<button onclick="kirimJawaban()">Kirim Jawaban</button>
<p id="hasil"></p>
<button onclick="kembaliMenuMapel()">‚¨Ö Kembali</button>
</div>

<!-- MENU GURU -->
<div id="guruBox" class="hidden">
<h3>Menu Guru</h3>

<select id="mapelGuru">
<option value="informatika">Informatika</option>
<option value="kka">KKA</option>
</select>

<h4>Materi</h4>
<input id="judulMateri" placeholder="Judul Materi">
<textarea id="isiMateri" placeholder="Isi Materi"></textarea>
<button onclick="simpanMateri()">Simpan Materi</button>

<hr>

<h4>Latihan / Soal</h4>
<select id="tipeSoal">
<option value="pg">Pilihan Ganda</option>
<option value="singkat">Jawaban Singkat</option>
<option value="panjang">Jawaban Panjang</option>
</select>

<textarea id="pertanyaan" placeholder="Pertanyaan"></textarea>

<div id="opsiPG">
<input id="opsiA" placeholder="Opsi A">
<input id="opsiB" placeholder="Opsi B">
<input id="opsiC" placeholder="Opsi C">
<input id="opsiD" placeholder="Opsi D">
<input id="jawabanPG" placeholder="Jawaban Benar (A/B/C/D)">
<input id="skorPG" type="number" placeholder="Skor Soal">
</div>

<button onclick="simpanSoal()">Simpan Soal</button>
<button onclick="logout()">Logout</button>
</div>

</div>

<script>
/* ===== DATA ===== */
let siswa = JSON.parse(localStorage.getItem('siswa')) || [];
let materi = JSON.parse(localStorage.getItem('materi')) || {informatika:[],kka:[]};
let soal   = JSON.parse(localStorage.getItem('soal'))   || {informatika:[],kka:[]};
let currentMapel = '';

/* ===== INIT KELAS & ABSEN (FIXED) ===== */
for (let i = 1; i <= 10; i++) {
  regKelas.innerHTML += `<option value="X-${i}">X-${i}</option>`;
}
for (let i = 1; i <= 40; i++) {
  regAbsen.innerHTML += `<option value="${i}">${i}</option>`;
}

/* ===== LOGIN ===== */
function login(){
 let u=loginUser.value, p=loginPass.value;

 if(u==='guru' && p==='admin123'){
  loginBox.classList.add('hidden');
  guruBox.classList.remove('hidden');
  return;
 }

 let s=siswa.find(x=>x.username===u && x.password===p);
 if(!s){
  infoLogin.innerText='Belum punya akun, silahkan klik Daftar';
  return;
 }

 loginBox.classList.add('hidden');
 menuSiswa.classList.remove('hidden');
 infoSiswa.innerText=`Selamat datang, ${s.nama} | ${s.kelas} | Absen ${s.absen}`;
}

/* ===== REGISTER ===== */
function showRegister(){
 loginBox.classList.add('hidden');
 registerBox.classList.remove('hidden');
}

function backLogin(){
 registerBox.classList.add('hidden');
 loginBox.classList.remove('hidden');
}

function registerSiswa(){
 if(!regNama.value||!regUser.value||!regPass.value||!regKelas.value||!regAbsen.value){
  alert('Semua data wajib diisi');
  return;
 }

 siswa.push({
  nama:regNama.value,
  username:regUser.value,
  password:regPass.value,
  kelas:regKelas.value,
  absen:regAbsen.value
 });

 localStorage.setItem('siswa',JSON.stringify(siswa));
 alert('Pendaftaran berhasil');
 backLogin();
}

/* ===== SISWA ===== */
function pilihMapel(m){
 currentMapel=m;
 menuSiswa.classList.add('hidden');
 menuMapel.classList.remove('hidden');
 judulMapel.innerText='Mata Pelajaran '+m.toUpperCase();
}

function bukaMateri(){
 menuMapel.classList.add('hidden');
 materiBox.classList.remove('hidden');
 materiList.innerHTML='';
 materi[currentMapel].forEach(m=>{
  materiList.innerHTML+=`<div class="card"><h4>${m.judul}</h4><p>${m.isi}</p></div>`;
 });
}

function bukaLatihan(){
 menuMapel.classList.add('hidden');
 latihanBox.classList.remove('hidden');
 soalList.innerHTML='';
 soal[currentMapel].forEach((s,i)=>{
  let h=`<div class="card"><p>${i+1}. ${s.pertanyaan}</p>`;
  if(s.tipe==='pg'){
   s.opsi.forEach(o=>{
    h+=`<label><input type="radio" name="s${i}" value="${o[0]}"> ${o}</label><br>`;
   });
  }else if(s.tipe==='singkat'){
   h+=`<input>`;
  }else{
   h+=`<textarea></textarea>`;
  }
  h+='</div>';
  soalList.innerHTML+=h;
 });
}

function kirimJawaban(){
 let skor=0;
 soal[currentMapel].forEach((s,i)=>{
  if(s.tipe==='pg'){
   let j=document.querySelector(`input[name="s${i}"]:checked`);
   if(j && j.value===s.jawaban) skor+=Number(s.skor);
  }
 });
 hasil.innerText='Skor Pilihan Ganda: '+skor;
}

function kembaliMenuMapel(){
 materiBox.classList.add('hidden');
 latihanBox.classList.add('hidden');
 menuMapel.classList.remove('hidden');
}

function kembaliSiswa(){
 menuMapel.classList.add('hidden');
 menuSiswa.classList.remove('hidden');
}

/* ===== GURU ===== */
function simpanMateri(){
 materi[mapelGuru.value].push({judul:judulMateri.value,isi:isiMateri.value});
 localStorage.setItem('materi',JSON.stringify(materi));
 alert('Materi tersimpan');
}

function simpanSoal(){
 let d={tipe:tipeSoal.value,pertanyaan:pertanyaan.value};
 if(d.tipe==='pg'){
  d.opsi=['A. '+opsiA.value,'B. '+opsiB.value,'C. '+opsiC.value,'D. '+opsiD.value];
  d.jawaban=jawabanPG.value;
  d.skor=skorPG.value;
 }
 soal[mapelGuru.value].push(d);
 localStorage.setItem('soal',JSON.stringify(soal));
 alert('Soal tersimpan');
}

function logout(){location.reload()}
</script>

</body>
</html>
